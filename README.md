# Генератор нагрузки на HLS сервер

Для запуска генератора нагрузки необходимо подготовить виртуальную машину под управлением Linux с несколькими vCPU для одновременного запуска нескольких потоков тестовых запросов.

На подготовленной виртуальной машине:
1. Установить `Docker` с `docker compose` по инструкции с сайта [docs.docker.com](https://docs.docker.com/)
1. Клонировать репозиторий с генератором нагрузки `git clone https://github.com/alexey-saveliev/hls-load-generator.git`
1. В склонированном репозитории в файле `locustfile.py` в переменной `stream_url` указать URL .m3u8 файла тестируемого потока
1. Запустить генератор нагрузки командой 
    ```
    docker compose up --scale worker=<num_threads>
    ```
    ,где <num_threads> количество одновременных тестовых потоков.
1. Подключиться к web-интерфейсу генератора нагрузки по адресу `http://<адрес или имя виртуальной машины>`
1. В открывшемся окне указать максимальное количество пользователей, от которых будут имитироваться запросы, и скорость их создания. Также в разделе *Advanced options* можно указать продолжительность тестирования.
1. Запустить тест и смотреть статистику хода его выполнения в web-интерфейсе
1. Для визуального контроля качества видео во время нагрузочного тестирования можно открыть URL тестируемого потока в *VLC Media Player*
